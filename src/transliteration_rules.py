# src/transliteration_rules.py

# ูุฐุง ุงูููู ูุญุชูู ุนูู ููุงุนุฏ ุงูููุญุฑุฉ ุงูุฃุณุงุณูุฉ ููุดุฑูุน TSO.
# ุชู ุชุตูููู ููููู ูุงุจูุงู ููุชูุณุน ูุงุณุชูุนุงุจ ุงูุชุญุฏูุซุงุช ุงููุณุชูุจููุฉ ูุงููุบุงุช ุงูุณุงููุฉ ุงูููุฏุซุฑุฉ.
# ==============================================================================

import json
import os

# ==============================================================================
# 1. ุงูููุงุนุฏ ุงูุงูุชุฑุงุถูุฉ ูููุถุน "ุงูุจุณูุท" (Common Use)
#    ุชูุฏู ูุฐู ุงูููุงุนุฏ ุฅูู ุงุญุชูุงุก ุนุงุฏุงุช ุงููุณุชุฎุฏููู ุงูุดุงุฆุนุฉ ูู ุงูููุญุฑุฉ ุงููุงุชูููุฉ
#    ูุชูุฌูููู ุจุฐูุงุก ูุญู ุชูุซูู TSO ุงูููุถู.
# ==============================================================================

BASIC_TRANSLITERATION_MAP = {
    'ุง': 'a', 'ุจ': 'b', 'ุช': 't', 'ุซ': 'th', 'ุฌ': 'j',
    'ุญ': 'h', 'ุฎ': 'kh', 'ุฏ': 'd', 'ุฐ': 'dh', 'ุฑ': 'r',
    'ุฒ': 'z', 'ุณ': 's', 'ุด': 'sh', 'ุต': 's', 'ุถ': 'd',
    'ุท': 't', 'ุธ': 'dh', 'ุน': 'a', 'ุบ': 'gh', 'ู': 'f',
    'ู': 'q', 'ู': 'k', 'ู': 'l', 'ู': 'm', 'ู': 'n',
    'ู': 'h', 'ู': 'w', 'ู': 'y', 'ุก': 'a', 'ู': 'a',
    'ุฉ': 'a', 'ุฃ': 'a', 'ุฅ': 'i', 'ุข': 'aa', 'ุค': 'u',
    'ุฆ': 'i',

    # ุงูุชุดููู ูุงูุญุฑูุงุช (ุนุงุฏุฉ ูุง ุชููุญุฑ ูู ุงููุถุน ุงูุจุณูุทุ ุฃู ุชุธูุฑ ููุฏูุฏ)
    'ู': '', 'ู': '', 'ู': '', 'ู': 'an', 'ู': 'un', 'ู': 'in',
    'ู': '', 'ู': '',

    # ุนูุงูุงุช ุงูุชุฑููู ูุงููุณุงูุงุช
    ' ': ' ', '.': '.', ',': ',', ';': ';', ':': ':',
    '!': '!', '?': '?', '(': '(', ')': ')', '[': '[',
    ']': ']', '{': '{', '}': '}', '-': '-', '_': '_',
    '/': '/', '\\': '\\', '&': '&', '@': '@', '#': '#',
    '$': '$', '%': '%', '^': '^', '*': '*', '+': '+',
    '=': '=', '<': '<', '>': '>', '|': '|', '`': '`',
    '~': '~', 'ุ': ',', 'ุ': ';', 'ุ': '?', 'ู': '-',
    'ูฐ': '', # ุฃูู ุฎูุฌุฑูุฉ
}

REVERSE_BASIC_TRANSLITERATION_MAP = {
    'a': 'ุง', 'b': 'ุจ', 't': 'ุช', 'th': 'ุซ', 'j': 'ุฌ',
    'h': 'ุญ', 'kh': 'ุฎ', 'd': 'ุฏ', 'dh': 'ุฐ', 'r': 'ุฑ',
    'z': 'ุฒ', 's': 'ุณ', 'sh': 'ุด', 'gh': 'ุบ', 'f': 'ู',
    'q': 'ู', 'k': 'ู', 'l': 'ู', 'm': 'ู', 'n': 'ู',
    'w': 'ู', 'y': 'ู', 'an': 'ุงู', 'un': 'ู', 'in': 'ู',
    'aa': 'ุข',
}

# ==============================================================================
# 2. ุงูููุงุนุฏ ุงูุฃูุงุฏูููุฉ (Academic Transliteration)
#    ุชุณุชุฎุฏู ุฑููุฒุงู ุฃูุซุฑ ุฏูุฉุ ุจูุง ูู ุฐูู ุฑููุฒ IPA ุฃู ุฑููุฒ ุฎุงุตุฉ ุดุงุฆุนุฉ ูู
#    ุงูุฏุฑุงุณุงุช ุงูุณุงููุฉ.
# ==============================================================================

ACADEMIC_TRANSLITERATION_MAP = {
    'ุง': 'a', 'ุจ': 'b', 'ุช': 't', 'ุซ': 'แนฏ', 'ุฌ': 'j',
    'ุญ': 'แธฅ', 'ุฎ': 'แธซ', 'ุฏ': 'd', 'ุฐ': 'แธ', 'ุฑ': 'r',
    'ุฒ': 'z', 'ุณ': 's', 'ุด': 'ลก', 'ุต': 'แนฃ', 'ุถ': 'แธ',
    'ุท': 'แนญ', 'ุธ': 'แบ', 'ุน': 'ษ', # ุงุณุชุฎุฏุงู ุฅุจุณูููู (epsilon)
    'ุบ': 'ฤก', 'ู': 'f', 'ู': 'q', 'ู': 'k', 'ู': 'l',
    'ู': 'm', 'ู': 'n', 'ู': 'h', 'ู': 'w', 'ู': 'y',
    'ุก': 'สพ', # glottal stop
    'ู': 'ฤ', # ุฃูู ููุตูุฑุฉ ูุฃูู ูุฏ
    'ุฉ': 'h', # ุฃู t ุฅุฐุง ูุงูุช ูู ุญุงูุฉ ุฅุถุงูุฉ (ูุซู -at)
    'ุฃ': 'สพa', 'ุฅ': 'สพi', 'ุข': 'สพฤ', 'ุค': 'สพu', 'ุฆ': 'สพi',

    # ุงูุญุฑูุงุช ูุงูุชุดููู (ุชูุซู ูู ุงููุถุน ุงูุฃูุงุฏููู)
    'ู': 'a', 'ู': 'u', 'ู': 'i', 'ู': 'an', 'ู': 'un', 'ู': 'in',
    'ู': 'ยฐ', # ุณููู (ูููู ุงุณุชุฎุฏุงู ุฑููุฒ ุฃุฎุฑู ูุซู โ)
    'ู': 'ห', # ุดุฏุฉ (ูููู ุงุณุชุฎุฏุงู ุฑููุฒ ุฃุฎุฑู ูุซู ห)

    # ุงููุฏูุฏ (ุชูุซูููุง ูุญุฑู ูุฏ ุทููู)
    'ุง': 'ฤ', # ุฃูู ุงููุฏ
    'ู': 'ลซ', # ูุงู ุงููุฏ
    'ู': 'ฤซ', # ูุงุก ุงููุฏ

    # ุนูุงูุงุช ุงูุชุฑููู ูุงููุณุงูุงุช (ููุง ูู)
    ' ': ' ', '.': '.', ',': ',', ';': ';', ':': ':',
    '!': '!', '?': '?', '(': '(', ')': ')', '[': '[',
    ']': ']', '{': '{', '}': '}','-': '-', '_': '_',
    '/': '/', '\\': '\\', '&': '&', '@': '@', '#': '#',
    '$': '$', '%': '%', '^': '^', '*': '*', '+': '+',
    '=': '=', '<': '<', '>': '>', '|': '|', '`': '`',
    '~': '~', 'ุ': ',', 'ุ': ';', 'ุ': '?', 'ู': '-',
    'ูฐ': 'ฤ', # ุฃูู ุฎูุฌุฑูุฉ ูุฃูู ูุฏ
}

# ==============================================================================
# 3. ููุงููุณ ุงูุชุญููู ุงูุนูุณู (ูู ุงููุงุชููู ุฅูู ุงูุนุฑุจู/ุงูุณุงูู)
#    ูุฐู ุงูููุงููุณ ุถุฑูุฑูุฉ ููุชุญููู ูู ุงูููุญุฑุฉ ุงููุงุชูููุฉ ุฅูู ุงูุฃุจุฌุฏูุงุช ุงูุฃุตููุฉ.
#    ุชุชุทูุจ ูุนุงูุฌุฉ ุฏูููุฉ ููุชุนุงูู ูุน ุงูุบููุถ ูุงูุฃุญุฑู ุงููุฑูุจุฉ.
#    ููุงุญุธุฉ: ุจูุงุก ุงูููุงููุณ ุงูุนูุณูุฉ ุฃูุซุฑ ุชุนููุฏุงู ูุฃูู ูุฏ ูููู ููุงู ุฃูุซุฑ ูู ุญุฑู ูุงุชููู
#    ููุซู ุญุฑูุงู ุนุฑุจูุงู ูุงุญุฏุงู (ูุซู 's' ูู 'ุณ' ู 'ุต').
#    ุณูููู ุจุจูุงุก ูุฐู ุงูููุงููุณ ุจุดูู ูุณูุญ ุจุงูุชุนุงูู ูุน ุงูุฃุญุฑู ุงููุฑูุจุฉ ุฃููุงู
#    (ูุซู 'sh' ูุจู 's') ููุนุงูุฌุฉ ุงูุบููุถ ูู transliteration_engine.py.
# ==============================================================================

REVERSE_ACADEMIC_TRANSLITERATION_MAP = {
    'a': 'ุง', 'b': 'ุจ', 't': 'ุช', 'แนฏ': 'ุซ', 'j': 'ุฌ',
    'แธฅ': 'ุญ', 'แธซ': 'ุฎ', 'd': 'ุฏ', 'แธ': 'ุฐ', 'r': 'ุฑ',
    'z': 'ุฒ', 'ุณ': 'ุณ', 'ลก': 'ุด', 'แนฃ': 'ุต', 'แธ': 'ุถ',
    'แนญ': 'ุท', 'แบ': 'ุธ', 'ษ': 'ุน', 'ฤก': 'ุบ', 'f': 'ู',
    'q': 'ู', 'k': 'ู', 'l': 'ู', 'm': 'ู', 'n': 'ู',
    'h': 'ู', 'w': 'ู', 'y': 'ู', 'สพ': 'ุก', 'ฤ': 'ุง',
    'ลซ': 'ู', 'ฤซ': 'ู', 'an': 'ุงู', 'un': 'ู', 'in': 'ู',
    'สพa': 'ุฃ', 'สพi': 'ุฅ', 'สพฤ': 'ุข', 'สพu': 'ุค', 'สพi': 'ุฆ',
    'ยฐ': 'ู', 'ห': 'ู',
    'ส': 'ุน', # ุฑูุฒ ุงูุนูู ููุง ุงูุชุฑุญุช
    'สฟ': 'ุน', # ุฑูุฒ ุงูุนูู ุงูุฃูุงุฏููู ุงูุดุงุฆุน
    'kh': 'ุฎ', # ุชูุซูู ุงูุฎุงุก ุงูุดุงุฆุน
    'x': 'ุฎ', # ุชูุซูู ุงูุฎุงุก IPA
    'th': 'ุซ', # ุชูุซูู ุงูุซุงุก ุงูุดุงุฆุน
    'dh': 'ุฐ', # ุชูุซูู ุงูุฐุงู ุงูุดุงุฆุน
    'sh': 'ุด', # ุชูุซูู ุงูุดูู ุงูุดุงุฆุน
    'gh': 'ุบ', # ุชูุซูู ุงูุบูู ุงูุดุงุฆุน
}


# ==============================================================================
# 4. ุฎูุงุฑุงุช ุฅุถุงููุฉ ูุฑููุฒ IPA ูููุณุชุฎุฏู (ูููู ุชูุนูููุง ูููู ุดุฎุตู ูุฎุตุต)
#    ูุฐู ุงูุฎูุงุฑุงุช ุชููุฑ ุชูุซููุงุช ุฏูููุฉ ููุฃุตูุงุช ุบูุฑ ุงูููุฌูุฏุฉ ุนูู ููุญุฉ ููุงุชูุญ QWERTY
#    ููููู ูููุณุชุฎุฏู ุงุฎุชูุงุฑ ุชูุนูููุง ูู ูุถุนู ุงูุฃูุงุฏููู ุฃู ุชุฎุตูุตูุง.
# ==============================================================================

IPA_EXTENDED_OPTIONS = {
    # ุญุฑู ุงูุนูู 'ุน'
    'ุน': {
        'default': 'ษ', # ุงูุชูุซูู ุงูุงูุชุฑุงุถู ูู ุงููุถุน ุงูุฃูุงุฏููู
        'options': ['ส', 'สฟ'] # ุฎูุงุฑุงุช IPA ุฅุถุงููุฉ ูููู ูููุณุชุฎุฏู ุชูุนูููุง
    },
    # ุญุฑู ุงูุซุงุก 'ุซ' (ุจุงูุฅุถุงูุฉ ุฅูู แนฏ)
    'ุซ': {
        'default': 'แนฏ',
        'options': ['ฮธ'] # Theta from IPA
    },
    # ุญุฑู ุงูุฎุงุก 'ุฎ'
    'ุฎ': {
        'default': 'แธซ', # ุงูุชูุซูู ุงูุฃูุงุฏููู ุงูุงูุชุฑุงุถู
        'options': ['x'] # 'x' for velar fricative
    },
    # ุงูุฃุญุฑู ุงูููุฎูุฉ (ุงูุตุงุฏุ ุงูุถุงุฏุ ุงูุทุงุกุ ุงูุธุงุก)
    'ุต': {
        'default': 'แนฃ',
        'options': ['sหค'] # s with pharyngealization diacritic
    },
    'ุถ': {
        'default': 'แธ',
        'options': ['dหค'] # d with pharyngealization diacritic
    },
    'ุท': {
        'default': 'แนญ',
        'options': ['tหค'] # t with pharyngealization diacritic
    },
    'ุธ': {
        'default': 'แบ',
        'options': ['รฐหค'] # eth with pharyngealization diacritic
    },
    # ูุฎุงุฑุฌ ุงูุนูุฉ ูุงููุฏูุฏ (ุงูุชุนุงูู ูุนูุง ูุชุทูุจ ูุนุงูุฌุฉ ุณูุงููุฉ ูู Engine)
    # ูููู ุชุนุฑูููุง ููุง ูุฑููุฒ ูููู ุฃู ูุฎุชุงุฑูุง ุงููุณุชุฎุฏู ูุชูุซูู ุงููุฏูุฏ
    'ุง_ูุฏ': { # ุฃูู ุงููุฏ
        'default': 'ฤ',
        'options': ['aห'] # a with length mark
    },
    'ู_ูุฏ': { # ูุงู ุงููุฏ
        'default': 'ลซ',
        'options': ['uห'] # u with length mark
    },
    'ู_ูุฏ': { # ูุงุก ุงููุฏ
        'default': 'ฤซ',
        'options': ['iห'] # i with length mark
    },
    # ุงูููุฒุฉ 'ุก'
    'ุก': {
        'default': 'สพ', # glottal stop
        'options': ['ส'] # IPA glottal stop
    },
    # ุงูุญุฑูุงุช ุงููุตูุฑุฉ (ูููู ุฅุถุงูุฉ ุชูุซูู IPA ููุง ุฅุฐุง ูุงู ูุทููุจุงูุ ูุซู ษ ููุดูุง)
    'ู': { # ูุชุญุฉ
        'default': 'a',
        'options': ['รฆ', 'ษ'] # near-open front unrounded vowel, near-open central vowel
    },
    'ู': { # ุถูุฉ
        'default': 'u',
        'options': ['ส', 'oฬ'] # near-close near-back rounded vowel, mid central rounded vowel
    },
    'ู': { # ูุณุฑุฉ
        'default': 'i',
        'options': ['ษช', 'eฬ'] # near-close near-front unrounded vowel, mid central unrounded vowel
    },
    # ุงูุดุฏุฉ (ุชูุฑุงุฑ ุงูุญุฑู)
    'ู': {
        'default': 'ห', # ุนูุงูุฉ ุงูุชูุฏุฉ
        'options': ['ห'] # ุนูุงูุฉ ุทูู ุงูุตูุช ูู IPA
    },
    # ุงูุณููู
    'ู': {
        'default': 'ยฐ', # ุนูุงูุฉ ุงูุฏุฑุฌุฉ
        'options': ['โ'] # ุฑูุฒ IPA ูุบูุงุจ ุงูุตูุช
    }
}

# ==============================================================================
# 5. ุงูุฃุญุฑู ุงูุณุงููุฉ ุงูุฅุถุงููุฉ (ุณูุชู ุชูุณูุนูุง ูุงุญูุงู ุจูุงุกู ุนูู ุงูุฃุจุญุงุซ ูุงููุบุงุช ุงูููุฏุซุฑุฉ)
#    ูุฐุง ุงููุณู ููุถุญ ุจููุฉ ุฅุถุงูุฉ ุญุฑูู ูู ุฃุจุฌุฏูุงุช ุณุงููุฉ ุฃุฎุฑู (ูุซู ุงูููููููุฉุ ุงูุขุฑุงููุฉุ ุงูุนุจุฑูุฉ ุงููุฏููุฉ).
#    ุณูุชู ุงุณุชุฎุฏุงููุง ูุชูุณูุน ูุทุงู ุงูููุญุฑุฉ ูุชุดูู ูุตูุตุงู ุชุงุฑูุฎูุฉ ููุบุงุช ููุฏุซุฑุฉ.
# ==============================================================================

SEMITIC_ADDITIONAL_CHARS = {
    # ูุซุงู: ุงูุฃูู ุงูููููููุฉ
    '๐ค': {'latin': 'สพ', 'description': 'Phoenician Aleph (Glottal Stop)'},
    # ูุซุงู: ุงูุญูุช ุงูููููููุฉ
    '๐ค': {'latin': 'แธฅ', 'description': 'Phoenician Heth (Voiceless Pharyngeal Fricative)'},
    # ูุซุงู: ุงูุนูู ุงูููููููุฉ
    '๐ค': {'latin': 'สฟ', 'description': 'Phoenician Ayin (Voiced Pharyngeal Fricative)'},
    # ... ูููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุฃุญุฑู ูู ุฃุจุฌุฏูุงุช ุฃุฎุฑู ...
}


# ==============================================================================
# 6. ูุธููุฉ ุชุญููู ุงูููุงุนุฏ ุงููุฎุตุตุฉ (Custom Profile Rules)
#    ุชุณูุญ ูููุณุชุฎุฏููู ุจุชุนุฑูู ููุงุนุฏ ุงูููุญุฑุฉ ุงูุฎุงุตุฉ ุจูู ุนุจุฑ ููู JSON.
# ==============================================================================

def load_custom_profile_rules(profile_path):
    """
    ุชุญููู ููุงุนุฏ ุงูููุญุฑุฉ ุงููุฎุตุตุฉ ูู ููู JSON.
    ูุชููุน ุงูููู JSON ุฃู ูุญุชูู ุนูู ููุชุงุญูู: "to_latin_map" ู "from_latin_map".
    """
    if not os.path.exists(profile_path):
        print(f"ุฎุทุฃ: ููู ุงูุชุนุฑูู ุงููุฎุตุต ุบูุฑ ููุฌูุฏ: {profile_path}")
        return {}, {}

    try:
        with open(profile_path, 'r', encoding='utf-8') as f:
            profile_data = json.load(f)

        # ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูููุงุชูุญ ุงููุชููุนุฉ
        to_latin_map = profile_data.get('to_latin_map', {})
        from_latin_map = profile_data.get('from_latin_map', {})

        return to_latin_map, from_latin_map

    except json.JSONDecodeError:
        print(f"ุฎุทุฃ: ููู '{profile_path}' ููุณ JSON ุตุงูุญุงู.")
        return {}, {}
    except Exception as e:
        print(f"ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ุชุญููู ุงูููู ุงูุดุฎุตู: {e}")
        return {}, {}
